<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="official_tree_view" model="ir.ui.view">
            <field name="name">bm.official.tree.view</field>
            <field name="model">bm.official</field>
            <field name="arch" type="xml">
                <tree string="Funcionarios" default_order='state' decoration-info="state=='check'" decoration-warning="state=='draft'" decoration-success="state=='ready'" decoration-danger="state=='error'">
                    <field name="name" />
                    <field name="identification_id" />
                    <field name="gross_salary" widget='monetary' />
                    <field name="job_id" readonly="1" />
                    <field name="state" readonly="1" />
                    <field name="account_number" readonly="1" />
                    <field name="account_name" readonly="1" />
                    <field name="reliable_base" string="Confiable" readonly="1" />
                </tree>
            </field>
        </record>

        <record id="official_form_view" model="ir.ui.view">
            <field name="name">bm.official.form.view</field>
            <field name="model">bm.official</field>
            <field name="arch" type="xml">
                <form string="Funcionarios" class="o_employee_form">
                    <field name="active" invisible="1"/>
                    <field name="company_id" invisible="1" />
                    <header attrs="{'invisible': [('id', '=', False)]}">
                        <button name="button_aprove" string="Aprobar" confirm="¿Estás seguro que deseas aprobar este registro? El funcionario quedará a espera de alta de cuenta" states="draft" class="oe_highlight oe_read_only" type="object" />
                        <button name="button_draft" string="Revertir" confirm="¿Estás seguro que deseas volver este registro a borrador?" states="check" class="oe_highlight oe_read_only" type="object" />
                        <button name="button_reset" string="Reiniciar" confirm="¿Estás seguro que deseas volver este registro a En Proceso?" states="error,ready" class="oe_highlight oe_read_only" type="object" />
                        <field name="state" widget="statusbar" statusbar_visible="draft,check,ready" />
                    </header>
                    <sheet>
                        <widget name="web_ribbon" title="Archived" bg_color="bg-danger" attrs="{'invisible': [('active', '=', True)]}"/>
                        <!--<widget name="web_ribbon" title="CANCELADO" bg_color="bg-danger" attrs="{'invisible': ['&amp;', ('account_name', '!=', 'CANCELADO'), ('account_name', 'in', ['INACTIVO', 'NORMAL', 'PACON'])]}"/>
                        <widget name="web_ribbon" title="INACTIVO" bg_color="bg-danger" attrs="{'invisible': ['&amp;', ('account_name', '!=', 'INACTIVO'), ('account_name', 'in', ['CANCELADO', 'NORMAL', 'PACON'])]}"/>-->
                        <field name="image_1920" widget='image' class="oe_avatar" options='{"zoom": true, "preview_image":"image_128"}'/>
                        <div class="oe_title">
                            <h1 class="oe_read_only">
                                <field name="name" class="text-uppercase" required="True" />
                            </h1>
                        </div>
                        <div class="oe_title oe_edit_only">
                            <h1 class="d-flex">
                                <field name="name_first" placeholder="Primer nombre" />
                                <field name="name_second" placeholder="Segundo nombre" />
                            </h1>
                            <h1 class="d-flex">
                                <field name="surname_first" placeholder="Primer apellido" />
                                <field name="surname_second" placeholder="Segundo apellido" />
                            </h1>
                            <!-- <h2>
                                <field name="job_title" placeholder="Puesto de trabajo" />
                            </h2>
                            <field name="category_ids" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}" placeholder="Tags"/> -->
                        </div>
                        <group>
                            <group>
                                <field name="admission_date" />
                                <field name="identification_type" required="True" string="Tipo de Cédula" />
                                <field name="country_of_birth" options='{"no_open": True, "no_create": True}' />
                                <field name="birthday" />
                                <field name="identification_expiry" />
                                <field name="real_address" class="o_force_ltr" />
                                <field name="neighborhood" class="o_force_ltr" attrs="{'readonly': [('department', '=', False)]}" options="{'no_create_edit': True, 'no_open': True}" />
                                <field name="city" class="o_address_city" options="{'no_create_edit': True, 'no_open': True}" attrs="{'readonly': [('country', '=', False)]}" />
                                <field name="work_phone" widget="phone" string="Teléfono Laboral" />
                                <field name="contract_type" />
                                <field name="gross_salary" />
                                <field name="email" string="E-mail" widget="email" />
                            </group>
                            <group>
                                <field name="identification_id" string="Cédula de Identidad" required="True" />
                                <field name="country" options='{"no_open": True, "no_create": True}' required="True" />
                                <field name="place_of_birth" options="{'no_create_edit': True, 'no_open': True}" attrs="{'readonly': [('country_of_birth', '=', False)]}" />
                                <field name="gender" />
                                <field name="marital" />
                                <field name="house_no" class="o_force_ltr" widget="integer" />
                                <field name="department" class="o_force_ltr" attrs="{'readonly': [('city', '=', False)]}" options="{'no_create_edit': True, 'no_open': True}" />
                                <field name="mobile_phone" widget="phone" string="Teléfono personal" />
                                <field name="job_id" />
                                <separator />
                                <field name='idenfitication_image_front' widget='image' />
                                <field name='idenfitication_image_back' widget='image' />
                            </group>
                        </group>
                        <notebook>
                            <page string="Más información">
                                <group>
                                    <group>
                                        <field name="contract_end_date" />
                                        <field name="street_transversal" class="o_force_ltr" />
                                        <field name="km_home_work" />
                                    </group>
                                    <group>
                                        <field name="departure_reason" />
                                        <field name="departure_description" />
                                    </group>
                                </group>
                                <label for="notes" />
                                <field name="notes" />
                            </page>
                            <page string="Información bancaria" groups="hcs_bm.group_bm_bank">
                                <group>
                                    <group>
                                        <field name="branch_number" readonly="1" />
                                        <field name="account_number" readonly="1" />
                                        <field name="account_name" readonly="1" />
                                        <field name="executive" readonly="1" />
                                        <field name="group_type" readonly="1" />
                                    </group>
                                    <group>
                                        <field name="sub_segmentation" />
                                        <field name="currency_type" />
                                        <field name="welcome_kit" domain="[('product_type', '=', 'kit')]" widget="selection" />
                                        <field name="reliable_base" />
                                    </group>
                                </group>
                            </page>
                            <page string="Cedula de identidad (PDF)">
                                <field name="idenfitication_image_pdf" widget="pdf_viewer" />
                                <field name="idenfitication_image_pdf_name" invisible="1" />
                            </page>
                        </notebook>
                    </sheet>
                    <!-- <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread" options="{'thread_level': 1}"/>
                    </div> -->
                </form>
            </field>
        </record>

        <record id="official_search_view" model="ir.ui.view">
            <field name="name">bm.official.search.view</field>
            <field name="model">bm.official</field>
            <field name="arch" type="xml">
                <search string="Filtrar movimientos">
                    <field name="name" string="Funcionarios" filter_domain="['|', '|', ('name_first', 'ilike', self), ('name_second', 'ilike', self), '|', ('surname_first', 'ilike', self), ('surname_second', 'ilike', self)]" />
                    <field name="identification_id" />
                    <field name="category_ids" />
                    <field name="job_id" />
                    <separator />
                    <filter name="state" string="Borrador" domain="[('state', '=', 'draft')]" />
                    <filter name="state" string="En proceso de alta" domain="[('state', '=', 'check')]" />
                    <filter name="state" string="Listo" domain="[('state', '=', 'ready')]" />
                    <filter name="state" string="Revisar" domain="[('state', '=', 'error')]" />
                    <separator />
                    <filter name="reliable_base" string="Validado" domain="[('reliable_base', '=', True)]" />
                    <separator />
                    <filter name="inactive" string="Archivados" domain="[('active', '=', False)]" />
                    <group expand="0" string="Group By">
                        <filter name="state" string="Provincia" domain="[]" context="{'group_by': 'state'}" />
                        <filter name="city" string="Ciudad" domain="[]" context="{'group_by': 'city'}" />
                        <filter name="department" string="Departamento" domain="[]" context="{'group_by': 'department'}" />
                        <filter name="neighborhood" string="Barrio" domain="[]" context="{'group_by': 'neighborhood'}" />
                    </group>
                    <!--
                        <filter name="marital" string="Estado civil" domain="[]" context="{'group_by': 'marital'}" />
                        <filter name="country_id" string="Pais" domain="[]" context="{'group_by': 'country_id'}" />
                        <searchpanel>
                            <field name="gender" icon="fa-transgender-alt" />
                            <field name="marital" icon="fa-user" />
                            <field name="job_id" icon="fa-users" />
                            <field name="identification_type" icon="fa-id-card" />
                        </searchpanel>
                    -->
                </search>
            </field>
        </record>

        <record id="action_official_aprove" model="ir.actions.server">
            <field name="name">Aprobar</field>
            <field name="model_id" ref="model_bm_official" />
            <field name="binding_model_id" ref="model_bm_official" />
            <field name="binding_view_types">list,form</field>
            <field name="state">code</field>
            <field name="code">
                action = record.button_aprove()
            </field>
        </record>

        <record id="action_official_valid_client_reliable_base" model="ir.actions.server">
            <field name="name">Validar</field>
            <field name="model_id" ref="model_bm_official" />
            <field name="binding_model_id" ref="model_bm_official" />
            <field name="binding_view_types">list,form</field>
            <field name="state">code</field>
            <field name="code">
                action = record.valid_client_reliable_base()
            </field>
        </record>

        <record id="action_official_create_officials_salary" model="ir.actions.server">
            <field name="name">Crear movimientos de salarios</field>
            <field name="model_id" ref="model_bm_official" />
            <field name="binding_model_id" ref="model_bm_official" />
            <field name="binding_view_types">list</field>
            <field name="state">code</field>
            <field name="code">
                action = record.create_officials_salary()
            </field>
        </record>

        <record id="action_official_open_view" model="ir.actions.act_window">
            <field name="name">Funcionarios</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">bm.official</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{}</field>
            <field name="domain">[]</field>
            <field name="help" type="html">
                <div class="oe_view_nocontent_create">
                    <p>SELECIONE SU ARCHIVO PARA REALIZAR LA CARGA</p>
                    <p>El archivo seleccionado debe ser en formato Excel o CSV</p>
                </div>
            </field>
        </record>

    </data>
</odoo>