<odoo>
  <data>
    <!-- Añadiendo campos a la vista Form del empleado -->
    <record id="sudameris_hr_employee_form" model="ir.ui.view">
      <field name="name">hr.employee.sudameris.hr.employee.form</field>
      <field name="model">hr.employee</field>
      <field name="inherit_id" ref="hr.view_employee_form" />
      <field name="arch" type="xml">
        <field name="name" position="replace">
          <field name="name" placeholder="Nombres" style="margin-right: 10px" required="True" />
          <field name="apellidos" placeholder="Apellidos" />
        </field>
        <field name="parent_id" position="after">
          <field name="tipo_moneda" />
          <field name="salario_bruto" />
        </field>
        <field name="identification_id" position="before">
          <field name="tipo_documento" />
          <field name="vencimiento_documento" />
        </field>
        <!-- Oculto la pagina Work Information -->
        <xpath expr="//page[@name='public']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <!-- Oculto la pagina RRHH -->
        <xpath expr="//page[@name='hr_settings']" position="attributes">
          <attribute name="invisible">1</attribute>
        </xpath>
        <!-- Agrego la pagina Sudameris -->
        <xpath expr="//page[@name='hr_settings']" position="after">
          <page name="hr_sudameris" string="Sudameris">
            <group>
                <group string="Información laboral">
                  <field name="tipo_grupo"/>
                  <field name="ejecutivo"/>
                  <field name="tipo_contrato"/>
                  <field name="fecha_ingreso"/>
                  <field name="fecha_fin_contrato"/>
                </group>
                <group string="Información bancaria">
                    <field name="numero_sucursal" />
                    <field name="numero_cuenta" />
                    <field name="nombre_cuenta"/>
                </group>
            </group>
          </page>
        </xpath>
      </field>
    </record>

    <!-- Agrego apellido a la vista Kanban -->
    <record id="sudameris_hr_employee_kanban" model="ir.ui.view">
      <field name="name">hr.employee.sudameris.hr.employee.kanban</field>
      <field name="model">hr.employee</field>
      <field name="inherit_id" ref="hr.hr_kanban_view_employees" />
      <field name="arch" type="xml">
        <field name="name" position="after">
          <field name="apellidos" />
        </field>
      </field>
    </record>

    <!-- vista tree del modelo movimiento de salarios -->
    <record id="tree_view_sudameris_salary_movement" model="ir.ui.view">
      <field name="name">hr.employee.tree.sudameris.salary.movement</field>
      <field name="model">sudameris_employee_salary_movement</field>
      <field name="arch" type="xml">
        <tree string="Movimientos de salario">
          <field name="empleado_nombres" />
          <field name="empleado_apellidos" />
          <field name="salario_bruto_def" />
          <field name="salario_importe" />
          <field name="fecha_pago" />
          <field name="modalidad_pago" />
          <field name="tipo_operacion" />
          <field name="state" />
        </tree>
      </field>
    </record>

    <!-- vista form del modelo movimiento de salarios -->
    <record id="form_view_sudameris_salary_movement" model="ir.ui.view">
      <field name="name">hr.employee.form.sudameris.salary.movement</field>
      <field name="model">sudameris_employee_salary_movement</field>
      <field name="arch" type="xml">
        <form string="Movimientos de salario">
          <header>
            <button name="button_aproved" string="Aprobar" confirm="¿Estás seguro que deseas aprobar este registro? Verifique el salario antes de aceptar" states="preliquidacion" class="oe_highlight" groups="hr.group_hr_manager" type="object"/>
            <button name="button_reset" string="Volver a borrador" confirm="¿Estás seguro que deseas volver este registro a borrador? Verifique el salario antes de aceptar"  states="aprobado" class="oe_highlight"
                  type="object"/>
            <field name="state" widget="statusbar" statusbar_visible="preliquidacion,aprobado,enproceso,cancelado,liquidado" statusbar_colors='{"cancelado":"red","aprobado":"blue","liquidado":"green"}'/>
          </header>
          <sheet>
            <group string="Información del empleado">
              <field name="empleado" />
              <field name="identification_id" />
              <field name="moneda" />
              <field name="salario_bruto_def" />
            </group>
            <group string="Información de liquidación">
              <group>
                <field name="tipo_cobro" />
                <field name="salario_importe" />
                <field name="fecha_pago" />
                <field name="modalidad_pago" />
              </group>
              <group>
                <field name="tipo_operacion" />
                <field name="codigo_operacion" />
                <field name="codigo_suboperacion" />
                <field name="referencia" placeholder="Número de referencia" />
              </group>
            </group> 
          </sheet>
        </form>
      </field>
    </record>

    <record id="open_view_sudameris_salary_movement" model="ir.actions.act_window">
      <field name="name">Movimiento de salarios</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">sudameris_employee_salary_movement</field>
      <field name="view_mode">tree,kanban,form</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">
          Agregar una nueva liquidación de Salario!
        </p>
        <p>Todavia no tienes ninguna liquidación, puedes agregar en el botón Crear!</p>
      </field>
    </record>

    <record id="action_sudameris_aproved" model="ir.actions.server">
      <field name="name">Aprobar</field>
      <field name="model_id" ref="model_sudameris_employee_salary_movement"/>
      <field name="binding_model_id" ref="model_sudameris_employee_salary_movement"/>
      <field name="binding_view_types">list</field>
      <field name="state">code</field>
      <field name="code">
        action = records.button_aproved()
      </field>
    </record>

    <record id="action_sudameris_send_data" model="ir.actions.server">
      <field name="name">Generar archivo .TXT</field>
      <field name="model_id" ref="model_sudameris_employee_salary_movement"/>
      <field name="binding_model_id" ref="model_sudameris_employee_salary_movement"/>
      <field name="binding_view_types">list</field>
      <field name="state">code</field>
      <field name="code">
        action = records._create_txt()
      </field>
    </record>

    <menuitem
        id="menu_hr_employee_sudameris_salary_movement"
        name="Movimiento de salarios"
        action="open_view_sudameris_salary_movement"
        parent="hr.menu_hr_employee_payroll"
        sequence="2"/>
  </data>
</odoo>